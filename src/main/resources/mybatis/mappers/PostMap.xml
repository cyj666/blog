<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.blog.mapper.PostMapper">
	 <cache type="com.blog.cache.MybatisRedisCache" />
 
	<select id="getPost" resultType="Post" parameterType="post">
		select post_id,topic_id,post_type,post_title,post_text,create_time from posts
		<where>
		<if test="boardId != null and boardId !='' ">
       	and post_id = #{postId}
        </if>
        <if test="boardName != null and boardName !='' ">
       	and topic_id = #{topicId}
        </if>
        <if test="boardDesc != null and boardDesc !='' ">
       	and post_type = #{postType}
        </if>
        <if test="boardDesc != null and boardDesc !='' ">
       	and post_title like #{postTitle}
        </if>
        <if test="boardDesc != null and boardDesc !='' ">
       	and post_text like #{postText}
        </if>
        <if test="boardDesc != null and boardDesc !='' ">
       	and create_time like #{createTime}
        </if>
		</where>
	</select> 
	
	<select id="getPosts" resultType="Post" parameterType="post">
		select post_id,topic_id,post_type,post_title,post_text,create_time from posts
		<where>
		<if test="boardId != null and boardId !='' ">
       	and post_id = #{postId}
        </if>
        <if test="boardName != null and boardName !='' ">
       	and topic_id = #{topicId}
        </if>
        <if test="boardDesc != null and boardDesc !='' ">
       	and post_type = #{postType}
        </if>
        <if test="boardDesc != null and boardDesc !='' ">
       	and post_title like #{postTitle}
        </if>
        <if test="boardDesc != null and boardDesc !='' ">
       	and post_text like #{postText}
        </if>
        <if test="boardDesc != null and boardDesc !='' ">
       	and create_time like #{createTime}
        </if>
		</where>
	</select> 
	
	<select id="getAllPost" resultType="Post" parameterType="post">
		select post_id,topic_id,post_type,post_title,post_text,create_time from posts
	</select> 
	
	
	<insert id="addPost" useGeneratedKeys="true" parameterType="post">
		insert into
		posts(topic_id,post_type,post_title,post_text,create_time)
		values(#{topicId},#{postType},#{postTitle},#{postText},#{createTime})
	</insert>

	<delete id="deletePost" parameterType="post">
        delete  from boards 
		<where>
		<if test="boardId != null and boardId !='' ">
       	and board_id = #{boardId}
        </if>
        <if test="boardName != null and boardName !='' ">
       	and board_name = #{boardName}
        </if>
        <if test="boardDesc != null and boardDesc !='' ">
       	and board_desc like #{boardDesc}
        </if>
		</where>
    </delete>
    
    <update id="updatePost" parameterType="post">
    update boards
    <set>
    	<if test="boardId != null and boardId !='' ">
       	and board_id = #{boardId}
        </if>
        <if test="boardName != null and boardName !='' ">
       	and board_name = #{boardName}
        </if>
        <if test="boardDesc != null and boardDesc !='' ">
       	and board_desc like #{boardDesc}
        </if>
    </set>
    </update>

</mapper>